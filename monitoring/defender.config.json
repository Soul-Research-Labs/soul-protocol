{
  "$schema": "https://docs.openzeppelin.com/defender/v2/reference/schema",
  "version": "2.0",
  "project": {
    "name": "ZASEON",
    "network": "mainnet",
    "description": "Cross-chain ZK privacy middleware"
  },
  "monitors": {
    "critical_events": {
      "name": "Zaseon Critical Events",
      "description": "Monitor critical security events across all Zaseon contracts",
      "type": "BLOCK",
      "network": "mainnet",
      "addresses": [],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "Paused(address)",
          "expression": null
        },
        {
          "eventSignature": "EmergencyWithdraw(address,address,uint256)",
          "expression": null
        },
        {
          "eventSignature": "CircuitBreakerTriggered()",
          "expression": null
        }
      ],
      "alertThreshold": {
        "amount": 1,
        "windowSeconds": 1
      },
      "notificationChannels": [
        "zaseon-pagerduty",
        "zaseon-slack-critical",
        "zaseon-email-critical"
      ],
      "riskCategory": "TECHNICAL"
    },
    "double_spend_detection": {
      "name": "Double-Spend Detection",
      "description": "Detect nullifier reuse attempts",
      "type": "BLOCK",
      "network": "mainnet",
      "addresses": [],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "DuplicateNullifierAttempt(bytes32,address)",
          "expression": null
        }
      ],
      "alertThreshold": {
        "amount": 1,
        "windowSeconds": 1
      },
      "notificationChannels": ["zaseon-pagerduty", "zaseon-slack-security"],
      "riskCategory": "FINANCIAL"
    },
    "proof_failures": {
      "name": "Proof Verification Failures",
      "description": "Monitor failed ZK proof verifications",
      "type": "BLOCK",
      "network": "mainnet",
      "addresses": [],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "ProofVerificationFailed(bytes32,string)",
          "expression": null
        }
      ],
      "alertThreshold": {
        "amount": 5,
        "windowSeconds": 3600
      },
      "notificationChannels": ["zaseon-slack-alerts"],
      "riskCategory": "TECHNICAL"
    },
    "relayer_slashing": {
      "name": "Relayer Slashing Events",
      "description": "Track when relayers are slashed",
      "type": "BLOCK",
      "network": "mainnet",
      "addresses": [],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "RelayerSlashed(address,uint256,bytes32)",
          "expression": null
        }
      ],
      "alertThreshold": {
        "amount": 1,
        "windowSeconds": 1
      },
      "notificationChannels": ["zaseon-slack-security"],
      "riskCategory": "FINANCIAL"
    },
    "large_transfers": {
      "name": "Large Value Transfers",
      "description": "Monitor transfers above threshold",
      "type": "BLOCK",
      "network": "mainnet",
      "addresses": [],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "Transfer(address,address,uint256)",
          "expression": "value > 1000000000000000000000"
        }
      ],
      "alertThreshold": {
        "amount": 1,
        "windowSeconds": 1
      },
      "notificationChannels": ["zaseon-slack-security", "zaseon-email-security"],
      "riskCategory": "FINANCIAL"
    },
    "admin_actions": {
      "name": "Admin Actions",
      "description": "Track privileged function calls",
      "type": "BLOCK",
      "network": "mainnet",
      "addresses": [],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "RoleGranted(bytes32,address,address)",
          "expression": null
        },
        {
          "eventSignature": "RoleRevoked(bytes32,address,address)",
          "expression": null
        },
        {
          "eventSignature": "Upgraded(address)",
          "expression": null
        }
      ],
      "alertThreshold": {
        "amount": 1,
        "windowSeconds": 1
      },
      "notificationChannels": ["zaseon-slack-admin"],
      "riskCategory": "ACCESS-CONTROL"
    },
    "cross_chain_messages": {
      "name": "Cross-Chain Message Monitoring",
      "description": "Track cross-chain message flow",
      "type": "BLOCK",
      "network": "mainnet",
      "addresses": [],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "MessageSent(bytes32,uint256,uint256,address,address,bytes,uint256,uint8)",
          "expression": null
        },
        {
          "eventSignature": "MessageExecuted(bytes32,bool,bytes)",
          "expression": null
        },
        {
          "eventSignature": "MessageChallenged(bytes32,address,bytes32)",
          "expression": null
        }
      ],
      "alertThreshold": {
        "amount": 1,
        "windowSeconds": 1
      },
      "notificationChannels": ["zaseon-slack-ops"],
      "riskCategory": "TECHNICAL"
    },
    "base_sepolia_bridge_monitoring": {
      "name": "Base Sepolia Bridge Monitoring",
      "description": "Monitor deployed bridge contracts on Base Sepolia testnet",
      "type": "BLOCK",
      "network": "base-sepolia",
      "addresses": [
        "0xDFBEe5bB4d4943715D4f8539cbad0a18aA75b602",
        "0x65CDCdA5ba98bB0d784c3a69C826cb3B59C20251",
        "0xBA63a3F3C5568eC6447FBe1b852a613743419D9f",
        "0x23824cDbD8Ca773c5DA0202f8f41083F81aF1135",
        "0x3E556432Ea021046ad4BE22cB94f713f98f4B76E",
        "0x2472BDB087590e4F4F4bE1243ec9533828eC0D9d",
        "0x583E650c0385FEd1E427dF68fa91b2d8E56Df20f"
      ],
      "abi": [],
      "eventConditions": [
        {
          "eventSignature": "Paused(address)",
          "expression": null
        },
        {
          "eventSignature": "CircuitBreakerTriggered()",
          "expression": null
        },
        {
          "eventSignature": "RelayCreated(bytes32,address,address,uint256)",
          "expression": null
        },
        {
          "eventSignature": "RateLimitExceeded(address,uint256)",
          "expression": null
        },
        {
          "eventSignature": "FraudProofSubmitted(bytes32,address)",
          "expression": null
        }
      ],
      "alertThreshold": {
        "amount": 1,
        "windowSeconds": 1
      },
      "notificationChannels": ["zaseon-slack-ops"],
      "riskCategory": "TECHNICAL"
    }
  },
  "actions": {
    "emergency_pause": {
      "name": "Emergency Pause Handler",
      "description": "Automatically execute emergency procedures",
      "trigger": "critical_events",
      "type": "AUTOTASK",
      "code": "scripts/defender/emergency-pause.js",
      "enabled": false
    },
    "alert_aggregator": {
      "name": "Alert Aggregator",
      "description": "Aggregate and deduplicate alerts",
      "trigger": "all",
      "type": "AUTOTASK",
      "code": "scripts/defender/alert-aggregator.js",
      "enabled": true
    }
  },
  "notifications": {
    "zaseon-pagerduty": {
      "type": "pagerduty",
      "name": "Zaseon PagerDuty",
      "config": {
        "serviceKey": "${PAGERDUTY_SERVICE_KEY}",
        "severity": "critical"
      }
    },
    "zaseon-slack-critical": {
      "type": "slack",
      "name": "Zaseon Slack Critical",
      "config": {
        "webhookUrl": "${SLACK_CRITICAL_WEBHOOK}"
      }
    },
    "zaseon-slack-security": {
      "type": "slack",
      "name": "Zaseon Slack Security",
      "config": {
        "webhookUrl": "${SLACK_SECURITY_WEBHOOK}"
      }
    },
    "zaseon-slack-alerts": {
      "type": "slack",
      "name": "Zaseon Slack Alerts",
      "config": {
        "webhookUrl": "${SLACK_ALERTS_WEBHOOK}"
      }
    },
    "zaseon-slack-admin": {
      "type": "slack",
      "name": "Zaseon Slack Admin",
      "config": {
        "webhookUrl": "${SLACK_ADMIN_WEBHOOK}"
      }
    },
    "zaseon-slack-ops": {
      "type": "slack",
      "name": "Zaseon Slack Ops",
      "config": {
        "webhookUrl": "${SLACK_OPS_WEBHOOK}"
      }
    },
    "zaseon-email-critical": {
      "type": "email",
      "name": "Zaseon Email Critical",
      "config": {
        "emails": ["security@zaseonprotocol.io"]
      }
    },
    "zaseon-email-security": {
      "type": "email",
      "name": "Zaseon Email Security",
      "config": {
        "emails": ["security@zaseonprotocol.io"]
      }
    }
  },
  "secrets": [
    "PAGERDUTY_SERVICE_KEY",
    "SLACK_CRITICAL_WEBHOOK",
    "SLACK_SECURITY_WEBHOOK",
    "SLACK_ALERTS_WEBHOOK",
    "SLACK_ADMIN_WEBHOOK",
    "SLACK_OPS_WEBHOOK"
  ]
}
